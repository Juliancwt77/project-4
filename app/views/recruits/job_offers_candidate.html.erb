<div class="container">
  <div class="row">

    <div class="heading heading-contact">
      <div class="col-lg-12">
        <div class="section-heading">
          <h2>My Job Offers</h2>
        </div>
      </div>
    </div>


          <!-- In our model, we have assumed one condidate can only have one posting, below condition is to deal with situation where the candidate have created one job profile but have not posted it. May need to refactor if we change model assumption one condidate can have many postings. -->
          <% if @current_candidate_individual_info.present? %>


          <% if @current_candidate_individual_info.status == 0 && !@current_candidate_individual_info.posting.recruits.exists? %>
          <div class="heading col-lg-12">
                  <h4>You have not posted your job profile, pls check your job profile.</h4>
          </div>
          <% elsif @current_candidate_individual_info.posting.recruits.exists? %>

          <div class="heading col-lg-12">
            <h4>Title: <%= @current_candidate_individual_info.title %> </h4>
            <h4>Rate ($/hr): <%= @current_candidate_individual_info.rate %> </h4>
            <h4>Date Listed: <%= @current_candidate_individual_info.updated_at.in_time_zone("Singapore") %> </h4>
          </div>

          <div class="col-md-12">
            <table class="table table-list-search">
              <thead>
                <tr>
                  <th>Date Offer Made</th>
                  <th>Company Name</th>
                  <th>Contact Name</th>
                  <th>Job Start Date</th>
                  <th>Job End Date</th>
                  <th>Job Scope</th>
                  <th>Message</th>
                  <th>Action</th>
                </tr>
              </thead>

              <tbody>

              <% @current_candidate_individual_info.posting.recruits.reverse_order.each do |offer_received| %>
                  <tr>
                      <td> <%= offer_received.updated_at %> </td>
                      <td> <%= offer_received.company.company_name %> </td>
                      <td> <%= offer_received.company.name %> </td>
                      <td> <%= offer_received.start_date.in_time_zone("Singapore") %> </td>
                      <td> <%= offer_received.end_date.in_time_zone("Singapore") %> </td>
                      <td> <%= offer_received.scope %> </td>
                      <td> Message here!!! </td>



                <%= offer_received.status %>
                <% if offer_received.status == 0 %>
                      <td>
                        <div>
                        <%= form_tag candidate_accept_offer_path, method: :get do %>
                        <%= hidden_field_tag :id, offer_received.id %>

                        <%= button_tag(type: 'submit', class:"btn btn-in-progress btn-md tip-right", title: 'Accept Offer') do %>
                        <span>Accept Offer</span>
                        <% end %>
                        <% end %>
                      </div>
                      <div>
                        <br>
                      <%= form_tag candidate_reject_offer_path, method: :get do %>
                      <%= hidden_field_tag :id, offer_received.id %>

                      <%= button_tag(type: 'submit', class:"btn btn-failure btn-md tip-right", title: 'Reject Offer') do %>
                      <span>Reject Offer</span>
                      <% end %>
                      <% end %>
                    </div>
                      </td>

                      <% elsif offer_received.status == 1 %>
                      <td>
                        <span class="btn btn-info btn-md disabled">Rejected Job Offer</span>
                      </td>


                    <% elsif offer_received.status == 2 %>
                    <td>
                    <div>
                    <%= form_tag candidate_complete_job_path, method: :get do %>
                    <%= hidden_field_tag :id, offer_received.id %>

                    <%= button_tag(type: 'submit', class:"btn btn-success btn-md tip-right", title: 'Complete Job') do %>
                    <span>Complete Job</span>
                    <% end %>
                    <% end %>
                  </div>
                </td>

                <% elsif offer_received.status == 3 %>
                <td>
                  <span class="btn btn-info btn-md disabled">Pending completion confirmation</span>
                </td>


                  <% end %>

                <% end %>


                  </tr>

          <% else !@current_candidate_individual_info.posting.recruits.exists? %>
            <div class="heading col-lg-12">
                  <h4>There are no offers at this moment.</h4>
                </div>
          <% end %>
        </tbody>

      </table>
    </div>
    <% else %>
    <div class="heading col-lg-12">
            <h4>Please create a job profile.</h4>
    </div>

    <% end %>
  </div>
</div>
